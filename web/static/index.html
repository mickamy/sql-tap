<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>sql-tap</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="app">
  <header>
    <h1>sql-tap</h1>
    <span class="stats" id="stats">0 queries</span>
    <div class="tab-group">
      <button class="tab-btn active" id="tab-events" onclick="switchView('events')">Events</button>
      <button class="tab-btn" id="tab-stats" onclick="switchView('stats')">Stats</button>
    </div>
    <div class="control-group">
      <button class="ctrl-btn" id="btn-pause" onclick="togglePause()">Pause</button>
      <button class="ctrl-btn" id="btn-clear" onclick="clearEvents()">Clear</button>
    </div>
    <input type="text" id="filter" placeholder="Filter (d>100ms op:select error ...)">
    <span class="status disconnected" id="status">connecting...</span>
  </header>
  <div id="table-wrap">
    <table>
      <thead>
        <tr>
          <th class="col-time">Time</th>
          <th class="col-op">Op</th>
          <th class="col-query">Query</th>
          <th class="col-dur">Duration</th>
          <th class="col-err">Status</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
  <div id="stats-wrap" style="display:none">
    <table>
      <thead>
        <tr>
          <th class="stats-col-count sortable" data-sort="count">Count</th>
          <th class="stats-col-dur sortable" data-sort="avg">Avg</th>
          <th class="stats-col-dur sortable" data-sort="p95">P95</th>
          <th class="stats-col-dur sortable" data-sort="max">Max</th>
          <th class="stats-col-dur sortable" data-sort="total">Total</th>
          <th class="stats-col-query">Query</th>
        </tr>
      </thead>
      <tbody id="stats-tbody"></tbody>
    </table>
  </div>
  <div id="detail">
    <div id="detail-content">
      <div class="detail-row"><span class="detail-label">Op:</span><span class="detail-value" id="d-op"></span></div>
      <div class="detail-row"><span class="detail-label">Time:</span><span class="detail-value" id="d-time"></span></div>
      <div class="detail-row"><span class="detail-label">Duration:</span><span class="detail-value" id="d-dur"></span></div>
      <div class="detail-row" id="d-rows-row"><span class="detail-label">Rows:</span><span class="detail-value" id="d-rows"></span></div>
      <div class="detail-row" id="d-tx-row"><span class="detail-label">Tx:</span><span class="detail-value" id="d-tx"></span></div>
      <div class="detail-row" id="d-err-row"><span class="detail-label">Error:</span><span class="detail-value" id="d-err" style="color:#f44747"></span></div>
      <div class="detail-row"><span class="detail-label">Query:</span></div>
      <div class="detail-query" id="d-query"></div>
      <div class="detail-args" id="d-args"></div>
      <div class="detail-buttons">
        <button class="btn" id="btn-explain" onclick="runExplain(false)">EXPLAIN</button>
        <button class="btn" id="btn-analyze" onclick="runExplain(true)">EXPLAIN ANALYZE</button>
        <button class="btn" onclick="copyQuery(false)">Copy Query</button>
        <button class="btn" onclick="copyQuery(true)">Copy with Args</button>
      </div>
      <div id="explain-output">
        <pre id="explain-pre"></pre>
      </div>
    </div>
  </div>
  <div id="stats-detail">
    <div id="stats-detail-content">
      <div class="detail-row" id="sd-metrics"></div>
      <div class="detail-row"><span class="detail-label">Query:</span></div>
      <div class="detail-query" id="sd-query"></div>
      <div class="detail-buttons">
        <button class="btn" onclick="copyStatsQuery()">Copy Query</button>
      </div>
    </div>
  </div>
</div>
<div id="toast"></div>
<script src="app.js"></script>
</body>
</html>
